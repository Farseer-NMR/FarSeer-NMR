# https://pip.pypa.io/en/stable/installing/
language: python
dist: bionic
#python:
#  - "3.6"
#  - "3.7"
#  - "3.8"
#cache: false

#os:
#  - linux
#  - osx
#  - windows

# safelist
branches:
  only:
    - master
    - ciconfig

#env:
  #global:
    #- CC_TEST_REPORTER_ID=
# https://github.com/WeblateOrg/translation-finder/blob/master/.travis.yml#L20-L26

matrix: 
  include:
    - os: windows
      language: sh
      python: 3.8
      env: 
        - TOXENV=check,radon
        - PATH=/c/Python38:/c/Python38/Scripts:$PATH
      before_install:
        - python --version
        - choco install python --version=3.8.1
        - pip3 install --upgrade pip
        #- python -m pip install --upgrade pip
        - python --version

    - os: windows
      language: sh
      python: 3.8
      env: 
        - TOXENV=docs
        - PATH=/c/Python38:/c/Python38/Scripts:$PATH
      before_install:
        - python --version
        - choco install python --version=3.8.1
        - python -m pip install --upgrade pip
        - python --version
    
    - os: windows
      language: sh
      python: 3.8
      env: 
        - TOXENV=py38,codecov
        - PATH=/c/Python38:/c/Python38/Scripts:$PATH
      before_install:
        - python --version
        - choco install python --version=3.8.1
        - python -m pip install --upgrade pip
        - python --version

    - os: windows
      language: sh
      python: 3.7
      env:
        - TOXENV=py37,codecov
        - PATH=/c/Python37:/c/Python37/Scripts:$PATH
      before_install:
        - python --version
        - choco install python --version=3.7.6
        - pip3 install --upgrade pip
        #- python -m pip install --upgrade pip
        - python --version
        - python --version

    - os: windows
      language: sh
      python: 3.6
      env:
        - TOXENV=py36,codecov
        - PATH=/c/Python36:/c/Python36/Scripts:$PATH
      before_install:
        - python --version
        - choco install python --version=3.6.8
        - pip3 install --upgrade pip
        #- python -m pip install --upgrade pip
        - python --version

    - os: linux
      python: 3.8
      env: TOXENV=check,radon
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.8
      env: TOXENV=docs
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.8
      env: TOXENV=py38,codecov
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.7
      env: TOXENV=py37,codecov
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.6
      env: TOXENV=py36,codecov
      before_install:
        - python -m pip install --upgrade pip wheel

    - os: osx
      osx_image: xcode11.3
      language: sh
      env: TOXENV=check,radon
      before_install:
        - python3 -m pip install --upgrade pip wheel virtualenv
    - os: osx
      osx_image: xcode11.3
      language: sh
      env: TOXENV=docs
      before_install:
        - python3 -m pip install --upgrade pip wheel virtualenv
    - os: osx
      osx_image: xcode11.3
      language: sh
      env: TOXENV=py38,codecov
      before_install:
        - python3 -m pip install --upgrade pip wheel virtualenv
    - os: osx
      osx_image: xcode10.3
      language: sh
      env: TOXENV=py37,codecov
      before_install:
        - python3 -m pip install --upgrade pip wheel virtualenv
    - os: osx
      osx_image: xcode9.4
      language: sh
      env: TOXENV=py36,codecov
      before_install:
        - python3 -m pip install --upgrade pip wheel virtualenv


#matrix:
#  include:
#    - os: linux
#      python: 3.8
#      env: TOXENV=check
#    - os: linux
#      python: 3.8
#      env: TOXENV=docs
#    - os: linux
#      python: 3.8
#      env: TOXENV=py38,codecov,coveralls
#    - os: linux
#      python: 3.7
#      env: TOXENV=py37,codecov,coveralls
#    - os: linux
#      python: 3.6
#      env: TOXENV=py36,codecov,coveralls
#    - os: osx
#      python: 3.8
#      env: TOXENV=check
#    - os: osx
#      python: 3.8
#      env: TOXENV=docs
#    - os: osx
#      python: 3.8
#      env: TOXENV=py38,codecov,coveralls
#    - os: osx
#      python: 3.7
#      env: TOXENV=py37,codecov,coveralls
#    - os: osx
#      python: 3.6
#      env: TOXENV=py36,codecov,coveralls
#    - os: windows
#      python: 3.8
#      env: TOXENV=check
#    - os: windows
#      python: 3.8
#      env: TOXENV=docs
#    - os: windows
#      python: 3.8
#      env: TOXENV=py38,codecov,coveralls
#    - os: windows
#      python: 3.7
#      env: TOXENV=py37,codecov,coveralls
#    - os: windows
#      python: 3.6
#      env: TOXENV=py36,codecov,coveralls
#
#before_install:
  #- chmod +x ./cc-test-reporter
  #- ./cc-test-reporter before-build

install:
  #- pip3 install -U pip
  #- python --version
  #- python -m pip --version
 # - if [[ $SENDCOV ]]  
  #- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - pip3 install tox tox-venv
  #- tox --version

script:
  #- tox -v
  - python3 --version
  - python --version
  - tox --version

#after_script:
    #- ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT

after_failure:
  - more .tox/log/* | cat
  - more .tox/*/log/* | cat

notifications:
  email:
    on_success: never
    on_failure: always
