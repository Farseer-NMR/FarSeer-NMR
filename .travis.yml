# https://pip.pypa.io/en/stable/installing/
language: python
dist: bionic
#python:
#  - "3.6"
#  - "3.7"
#  - "3.8"
#cache: false

#os:
#  - linux
#  - osx
#  - windows

# safelist
branches:
  only:
    - master
    - ciconfig

#env:
  #global:
    #- CC_TEST_REPORTER_ID=
# https://github.com/WeblateOrg/translation-finder/blob/master/.travis.yml#L20-L26

matrix: 
  include:
    - os: windows
      language: sh
      python: 3.8
      env: 
        - TOXENV=check,radon
        #- SENDCOV=1
      before_install:
        - choco install python --version=3.8.1 --params "/InstallDir:C:\\Python"
        - export PATH="/c/Python:/c/Python/Scripts:$PATH"
        #- python -m pip install --upgrade pip wheel
    - os: windows
      language: sh
      python: 3.8
      env: 
        - TOXENV=docs
        #- SENDCOV=1
      before_install:
        - choco install python --version=3.8.1 --params "/InstallDir:C:\\Python"
        - export PATH="/c/Python:/c/Python/Scripts:$PATH"
        #- python -m pip install --upgrade pip wheel
    - os: windows
      language: sh
      python: 3.8
      env: 
        - TOXENV=py38,codecov
        #- SENDCOV=1
      before_install:
        - choco install python --version=3.8.1 --params "/InstallDir:C:\\Python"
        - export PATH="/c/Python:/c/Python/Scripts:$PATH"
        #- python -m pip install --upgrade pip wheel
    - os: windows
      language: sh
      python: 3.7
      env:
        - TOXENV=py37,codecov
        #- SENDCOV=1
      before_install:
        - choco install python --version=3.7.6 --params "/InstallDir:C:\\Python"
        - export PATH="/c/Python:/c/Python/Scripts:$PATH"
        #- python -m pip install --upgrade pip wheel
    - os: windows
      language: sh
      python: 3.6
      env:
        - TOXENV=py36,codecov
        #- SENDCOV=1
      before_install:
        - choco install python --version=3.6.8 --params "/InstallDir:C:\\Python"
        - export PATH="/c/Python:/c/Python/Scripts:$PATH"
        #- python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.8
      env: TOXENV=check,radon
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.8
      env: TOXENV=docs
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.8
      env: TOXENV=py38,codecov
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.7
      env: TOXENV=py37,codecov
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: linux
      python: 3.6
      env: TOXENV=py36,codecov
      before_install:
        - python -m pip install --upgrade pip wheel
    - os: osx
      language: sh
      python: 3.8
      env: TOXENV=check,radon
      before_install:
        #- brew update
        #- brew unlink python@2
        #- brew upgrade python@3.8
        - python3 -m pip install --upgrade pip wheel virtualenv
        - virtualenv .venv -p python3
        - source .venv/bin/activate
    - os: osx
      language: sh
      python: 3.8
      env: TOXENV=docs
      before_install:
        #- brew update
        #- brew unlink python@2
        #- brew upgrade python@3.8
        - python3 -m pip install --upgrade pip wheel virtualenv
        - virtualenv .venv -p python3
        - source .venv/bin/activate
    - os: osx
      language: sh
      python: 3.8
      env: TOXENV=py38,codecov
      before_install:
        - pip install -U pip
    - os: osx
      language: sh
      python: 3.7
      env: TOXENV=py37,codecov
      before_install:
        - pip install -U pip
    - os: osx
      language: sh
      python: 3.6
      env: TOXENV=py36,codecov
      before_install:
        - pip install -U pip


#matrix:
#  include:
#    - os: linux
#      python: 3.8
#      env: TOXENV=check
#    - os: linux
#      python: 3.8
#      env: TOXENV=docs
#    - os: linux
#      python: 3.8
#      env: TOXENV=py38,codecov,coveralls
#    - os: linux
#      python: 3.7
#      env: TOXENV=py37,codecov,coveralls
#    - os: linux
#      python: 3.6
#      env: TOXENV=py36,codecov,coveralls
#    - os: osx
#      python: 3.8
#      env: TOXENV=check
#    - os: osx
#      python: 3.8
#      env: TOXENV=docs
#    - os: osx
#      python: 3.8
#      env: TOXENV=py38,codecov,coveralls
#    - os: osx
#      python: 3.7
#      env: TOXENV=py37,codecov,coveralls
#    - os: osx
#      python: 3.6
#      env: TOXENV=py36,codecov,coveralls
#    - os: windows
#      python: 3.8
#      env: TOXENV=check
#    - os: windows
#      python: 3.8
#      env: TOXENV=docs
#    - os: windows
#      python: 3.8
#      env: TOXENV=py38,codecov,coveralls
#    - os: windows
#      python: 3.7
#      env: TOXENV=py37,codecov,coveralls
#    - os: windows
#      python: 3.6
#      env: TOXENV=py36,codecov,coveralls
#
#before_install:
  #- chmod +x ./cc-test-reporter
  #- ./cc-test-reporter before-build

install:
  #- python --version
  #- python -m pip --version
 # - if [[ $SENDCOV ]]  
  #- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - pip install tox tox-venv
  #- tox --version

script:
  #- tox -v
  - python --version
  - tox --version

#after_script:
    #- ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT

after_failure:
  - more .tox/log/* | cat
  - more .tox/*/log/* | cat

notifications:
  email:
    on_success: never
    on_failure: always
